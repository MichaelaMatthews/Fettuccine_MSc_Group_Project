#Join L1_Assign - L1_seqs
CREATE TABLE L1_Repeats as 
SELECT L1_assign.ID, L1_assign.Repeat_Name, L1_assign.Superfamily, L1_seqs.Chromosome, L1_seqs.genoStart, L1_seqs.genoEnd, L1_seqs.Sequence
FROM L1_assign
JOIN L1_seqs ON L1_assign.ID = L1_seqs.ID

#GROUP HERVs by Family:
SET SESSION group_concat_max_len = 1000000000000;
SELECT Family, MIN(SuperFamily), GROUP_CONCAT(DISTINCT Repeat_Name SEPARATOR ', ') as Repeat_Name,
GROUP_CONCAT(DISTINCT ID SEPARATOR ', ') as ID,
COUNT(ID) as Counts
FROM HERV_Repeats
GROUP BY Family

#GROUP HERVs by Superfamily:
SET SESSION group_concat_max_len = 1000000000000;
CREATE TABLE HERV_Groupby_Superfamilies as
SELECT Superfamily, GROUP_CONCAT(DISTINCT Repeat_Name SEPARATOR ', ') as Repeat_Name,
GROUP_CONCAT(DISTINCT ID SEPARATOR ', ') as ID,
COUNT(ID) as Counts
FROM HERV_Repeats
GROUP BY Superfamily

#GROUP L1 by Repeats:
SET SESSION group_concat_max_len = 1000000000000;
CREATE TABLE L1_Groupby_Repeats as
SELECT Repeat_Name, GROUP_CONCAT(DISTINCT ID SEPARATOR ', ') as ID,
COUNT(ID) as Counts
FROM L1_Repeats
GROUP BY Repeat_Name
